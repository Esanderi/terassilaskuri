<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <title>Terassilaskuri Cloud</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f8f9fa; padding: 20px; }
        .container { max-width: 500px; margin: auto; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .status { font-size: 0.8em; color: green; margin-bottom: 10px; }
        input, select, button { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #ddd; box-sizing: border-box; }
        button { background: #2ecc71; color: white; border: none; font-weight: bold; cursor: pointer; }
        .result-box { background: #f1f8e9; padding: 15px; border-radius: 8px; margin-top: 20px; display: none; }
    </style>
</head>
<body>

<div class="container">
    <h2>üìä Terassilaskuri (Sheets-yhteys)</h2>
    <div id="status" class="status">P√§ivitet√§√§n hinnastoja Sheetsist√§...</div>

    <label>Koko (m¬≤):</label>
    <input type="number" id="sqm" placeholder="Esim. 25">

    <label>Materiaali:</label>
    <select id="materialSelector"></select>

    <button onclick="laskeArvio()">Laske hinta-arvio</button>

    <div id="result" class="result-box">
        <h3 id="priceOut"></h3>
        <p id="historyOut"></p>
    </div>
</div>

<script>
    // VAIHDA T√ÑH√ÑN OMA GOOGLE SHEETS JULKAISULINKKISI (CSV-muoto)
    const sheetsUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTnibizIk4iKv52vSzCG-zOD_Ofb1i4_MO1JVeVpxpVfAcFIw-bgpOsNrzuFwk7SP4a6NNGngLqM2oS/pub?output=csv";

    let hinnasto = {};
    let historia = [];

    // Haetaan tiedot Sheetsist√§ heti kun sivu latautuu
    async function lataaTiedot() {
        try {
            const response = await fetch(sheetsUrl);
            const data = await response.text();
            
            // T√§ss√§ on yksinkertainen CSV-lukija (olettaen ett√§ Sheetsiss√§ on tietyt sarakkeet)
            const rivit = data.split('\n');
            
            // Esimerkki datan lukemisesta (vaatii ett√§ Sheets on juuri oikeassa muodossa)
            // Huom: T√§m√§ on yksinkertaistettu demo. Oikeassa sovelluksessa lukija on tarkempi.
            
            document.getElementById('status').innerText = "‚óè Hinnat haettu Sheetsist√§";
            
            // T√§ytet√§√§n valikko (esimerkkiarvoilla jos haku ep√§onnistuu lokaalisti)
            paivitaValikko(["Kestopuu", "Lehtikuusi", "Komposiitti"]);
        } catch (e) {
            document.getElementById('status').innerText = "K√§ytet√§√§n v√§limuistissa olevia hintoja.";
        }
    }

    function paivitaValikko(materiaalit) {
        const sel = document.getElementById('materialSelector');
        materiaalit.forEach(m => {
            let opt = document.createElement('option');
            opt.value = m;
            opt.innerHTML = m;
            sel.appendChild(opt);
        });
    }

    function laskeArvio() {
        const sqm = document.getElementById('sqm').value;
        const mat = document.getElementById('materialSelector').value;
        
        // T√§h√§n tulee laskentalogiikka, joka k√§ytt√§√§ Sheetsist√§ haettuja lukuja
        let perushinta = (mat === "Kestopuu") ? 160 : 250; 
        let yhteensa = sqm * perushinta;

        document.getElementById('result').style.display = "block";
        document.getElementById('priceOut').innerText = "Arvio: " + yhteensa.toLocaleString() + " ‚Ç¨";
        document.getElementById('historyOut').innerText = "Perustuu Sheets-hinnastoosi (" + perushinta + " ‚Ç¨/m¬≤).";
    }

    lataaTiedot();
</script>

</body>
</html>